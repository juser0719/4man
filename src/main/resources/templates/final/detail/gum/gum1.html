<!DOCTYPE html>
<meta charset="UTF-8">
<html xmlns:th="http://">



<head>
  <!--JS-->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <!--CSS-->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link
    href="https://fonts.googleapis.com/css?family=Anton|Cute+Font|Gamja+Flower|Hi+Melody|Poor+Story|Stylish|Sunflower:300&display=swap&subset=korean"
    rel="stylesheet">
  <style>
    .color {
      background-color: blueviolet;
    }

    .color:hover {
      background-color: rebeccapurple;
    }

    .e {
      font-family: 'Stylish', sans-serif;
    }

    .b {
      font-family: 'Hi Melody', cursive;
      font-size: 23px;
    }

    .c {
      font-family: 'Gamja Flower', cursive;
      font-size: 40px;
    }

    .d {
      font-family: 'Cute Font', cursive;
      font-size: 20px;
    }

    .e {
      font-family: 'Poor Story', cursive;
    }

    .f {
      font-family: 'Anton', sans-serif;
    }

    .g {
      font-family: 'Sunflower', sans-serif;
    }
  </style>
  <title></title>
  <script language="JavaScript">
    //1. 생길 때 수량, 가격 올리기
    //2. readonly 속성 넣기
    // 수량 늘리기: 가격 더할 때마다 기존에 있던 input element의 값을 받아옴 -> 3,900원을 더함(데이터베이스의 값, 후에 rest api로 가져와야한다) -> 수량 더함
    // var sell_price;
    // var amount;

    function init() {
      sell_price = document.form.sell_price.value;
      amount = document.form.amount.value;
      document.form.sum.value = sell_price;
      //change();
    }

    function add(price) { //총 수량 및 가격에 더해주기
      hm = parseInt($("#sell_price").val()) //수량
      sum = parseInt($("#sell_sum").val()) //가격
      hm++
      sum += price
      $("#amount").val(hm)
      $("#sum").val(sum)
    }
    function del(price) { //총 수량 및 가격에 빼주기
      hm = parseInt($("#sell_price").val()) //수량
      sum = parseInt($("#sell_sum").val()) //가격
      hm--
      sum -= price
      $("#amount").val(hm)
      $("#sum").val(sum)
    }
    /*
    function change() {
      hm = document.form.amount;
      sum = document.form.sum;

      sum.value = parseInt(hm.value) * sell_price;
    }
    */

    $(function () {
      var btn_index = 1
      var item_index_list = []
      var price = 3900 //가격
      //버튼 생성
      $("#select").change(function () {
        if ($(this).children("option:selected").attr("id") != "default_choose") {
          var start_div = "<div " + "id= " + "item_index" + btn_index + ">"
          var plus_button = "<input type=" + "'button' " + "value= " + " '+'  " + "id=" + "'plus_editItem_btn" + btn_index.toString() + "' " + "name='plus_editItem_btn' " + "readonly" + ">"
          var minus_button = "<input type=" + "'button' " + "value= " + " '-'  " + "id=" + "'minus_editItem_btn" + btn_index.toString() + "' " + "name='minus_editItem_btn' " + "readonly" + ">"
          var remove_button = "<input type=" + "'button'" + "value= " + " 'X'  " + "id=" + "'remove_editItem_btn" + btn_index.toString() + "' " + "name='remove_editItem_btn' " + "readonly" + ">"
          var amount = "<input type=" + "number " + "name=" + "amount" + " value= " + "1" + "  size=" + "3" + " " + "id=" + "'amount" + btn_index.toString() + "'" + ">"
          var end_div = "</div>"
          var text = $(this).children("option:selected").text()
          $("#item-area").append(start_div + text + amount + plus_button + minus_button + remove_button + end_div);
          item_index_list.push(btn_index)
          btn_index += 1
          console.log(document.getElementById("plus_editItem_btn1").id)
          console.log(document.getElementById("minus_editItem_btn1").id)
          console.log(document.getElementById("remove_editItem_btn1").id)
          console.log(document.getElementById("amount1"))
          console.log($("#select").html())
          calculate("plus_editItem_btn")
        }
      })
      //분화시킬 필요가 있음, 가격
      function calculate(button_type) {
        var price = 3900
        console.log(sum)
        console.log(typeof sum)
        if (button_type == "remove_editItem_btn") {

        } else if (button_type == "plus_editItem_btn") {
          $("#sell_price").val(parseInt($("#sell_price").val()) + 1) //수량
          $("#sell_sum").val(parseInt($("#sell_price").val()) * 3900)
        } else if (button_type == "minus_editItem_btn") {
          $("#sell_price").val(parseInt($("#sell_price").val()) - 1)
          $("#sell_sum").val(parseInt($("#sell_price").val()) * 3900)
        } else if (button_type == "minus_editItem_btn") {

        }

      }


      //needs to be optimized
      $(document).ready(function () {
        $(document).on('click', "input[id*='editItem']", function (e) { //id 이름에 editItem이 포함되는 경운

          //amount index 찾기



          var editItem_id = e.target.id //editItem_id: 클릭한 element의 id

          if (editItem_id.includes("remove_editItem_btn")) { //항목 제거를 의미하는 id 포함
            var btn_name = "remove_editItem_btn"
          }
          else if (editItem_id.includes("plus_editItem_btn")) { //상품 개수 추가를 의미하는 id 포함
            var btn_name = "plus_editItem_btn"
            var edit_amount = 1

          }
          else if (editItem_id.includes("minus_editItem_btn")) { //상품 개수 감소를 의미하는 id 포함
            var btn_name = "minus_editItem_btn"
            var edit_amount = -1
          }
          else {
            console.log("ERROR IN GUM1")
          }


          var editItem_length = btn_name.length
          var editItem_index_str = editItem_id.substring(editItem_length)
          var value_str = $("#amount" + editItem_index_str).val()
          var value_edited = parseInt(value_str) + edit_amount

          if (btn_name === "remove_editItem_btn") {
            $("#item_index" + editItem_index_str).remove() //항목 제거
          }
          else if (!(edit_amount == -1 && $("#amount" + editItem_index_str).val() <= 1)) {
            $("#amount" + editItem_index_str).val(value_edited) //상품 개수 1 이하로 줄일 수 없음
          }
          calculate(btn_name)




          // })
          // $(document).on('click', "input[id*='minus_editItem']", function () {

          //   //amount index 찾기
          //   var btn_name = "minus_editItem_btn"
          //   var edit_amount = -1

          //   var editItem_length = btn_name.length
          //   var editItem_index_str = editItem_id.substring(editItem_length)
          //   var value_str = $("#amount" + editItem_index_str).val()
          //   var value_edited = parseInt(value_str) + edit_amount
          //   $("#amount" + editItem_index_str).val(value_edited)


          // })

          // $(document).on('click', "input[id*='remove_editItem']", function () {

          //   //amount index 찾기
          //   var btn_name = "minus_editItem_btn"
          //   var edit_amount = 1

          //   var editItem_length = btn_name.length
          //   var editItem_index_str = editItem_id.substring(editItem_length)
          //   var value_str = $("#amount" + editItem_index_str).val()
          //   var value_edited = parseInt(value_str) + edit_amount
          //   $("#amount" + editItem_index_str).val(value_edited)


          // })

        })
      })
      //QUESTION: WHY $("input[id*='plus_btn']", function (){ ... }) EXPRESSION DOESN'T WORK?
      //READ THIS: https://www.tutorialrepublic.com/faq/how-to-bind-click-event-to-dynamically-added-elements-in-jquery.php


      //버튼 눌렸을 때
      /*function addItem(this){
        
        function add() {
      hm = document.form.amount;
      sum = document.form.sum;
      hm.value++;
      sum.value = parseInt(hm.value) * sell_price;
    }
    function del() {
      hm = document.form.amount;
      sum = document.form.sum;
      if (hm.value > 1) {
        hm.value--;
        sum.value = parseInt(hm.value) * sell_price;
      }
    }
      }*/


    })

  </script>
</head>

<body onload="init();">
  <!--modal-->
  <form action="/signin">
    <div class="modal fade" id="login" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header text-center bg-secondary text-white">
            <h4 class="modal-title w-100 ">Sign in</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body mx-3">
            <div class="md-form mb-5">
              <label data-error="wrong" data-success="right" for="defaultForm-email"><strong>ID</strong></label>
              <input type="email" id="defaultForm-email" class="form-control validate" name="logid">
            </div>
            <div class="md-form mb-4">
              <label data-error="wrong" data-success="right" for="defaultForm-pass"><strong>PW</strong></label>
              <input type="password" id="defaultForm-pass" class="form-control validate " name="logpw">
            </div>
          </div>
          <div class="modal-footer d-flex justify-content-center">
            <button type="submit" class="btn btn-default btn-outline-secondary">Login</button>
          </div>
        </div>
      </div>
    </div>
  </form>
  <!--modal-->
  <!--Header-->
  <header class="blog-header ">

    <!--제가 만든 제과  제목-->
    <div class="jumbotron d-flex p-3 p-md-5 text-dark rounded bg-white text-center justify-content-center border-bottom"
      style="background: url(/study/public/images/header/header.PNG) no-repeat; background-position: center center;">
      <div class="col-md-8 px-0">
        <e href="/" class="e">
          <h1 class="text-dark display-4" style="font-size: 70px;">제가 만든 제과 </h1>
        </e>
        <p class="my-3 e">
          made by JBBK
        </p>
      </div>
    </div>
    <!--제가 만든 제과  제목-->
    <!--nav bar-->
    <div class="container b ">
      <div class="row flex-nowrap justify-content-between align-items-center">
        <div class="col-8">
          <e class="text-muted p-1 " href="#">회사 소개</e>
          <e class="text-muted p-1 " href="/small_pro/Introduction_item">제품 소개</e>
          <e class="text-muted p-1 " href="#"> 이벤트 </e>
          <e class="text-muted p-1 " href="#"> 고객센터 </e>
          <e class="text-muted p-1 " href="#"> 인재채용 </e>
        </div>

        <div class="col-4 d-flex justify-content-end align-items-center">
          <button class="text-muted bg-white border-0 b" data-toggle="modal" data-target="#login">Sign In </button>/
          <!--로그인 팝업창-->
          <e class="text-muted bg-white border-0 b" href="/small_pro/SignUp" role="button">Sign Up</e>
        </div>
      </div>
    </div>
    <!--nav bar-->
  </header>

  <!--body-->
  <div class="layout-wrapper goods-view-area">
    <div class="container d-flex ">
      <div class="row">
        <div class="span5">
          <div class="">
            <img class="py-5" src="http://img-cf.kurly.com/shop/data/goods/1538985810995l0.jpg">
          </div>
        </div>
        <div class="span4 offset5 pl-5">
          <h1 class="name pt-5"> 천연치클 껌 4종</h1>
          <p class="text-left">건강과 환경을 생각하는 껌</p>
          <table class="table mt-5">
            <thead>
            </thead>
            <tbody>
              <tr>
                <th scope="row">판매가</th>
                <td>3,900원</td>
              </tr>
              <tr>
                <th scope="row">판매단위</th>
                <td>PK</td>
              </tr>
              <tr>
                <th scope="row">포장타입</th>
                <td>상온/종이 포장</td>
              </tr>
              <tr>
                <th scope="row">중량/용량</th>
                <td>12개입 / 19g</td>
              </tr>
              <tr>
                <th scope="row">단품 골라담기</th>
                <td>
                  <select id="select">
                    <option selected id="default_choose">==단품골라담기 선택==</option>
                    <option value="3900" name="v1" id="v1">후레시 민트 (+3,900)</option>
                    <option value="3900" name="v2" id="v2">후레시 레몬 (+3,900)</option>
                    <option value="3900" name="v3" id="v3">후레시 솔티 (+3,900)</option>
                    <option value="3900" name="v4" id="v4">후레시 펀치 (+3,900)</option>
                  </select>
                </td>
              </tr>
            </tbody>
          </table>

          <h2>총 금액 : <span id="value"></span></h2>
          <form name="form" method="get">
            수량 : <input type=hidden name="sell_price" value="3900" readonly>
            <!--<input type="text" name="amount" value="1" size="3" onchange="change();">-->
            <input type="number" name="amount" value="0" size="3" id="sell_price" readonly>
            <div id="item-area">
            </div>

            금액 : <span id="sum"></span><input type="number" name="sum" size="11" id="sell_sum" value="0" readonly>원
          </form>

        </div>
      </div>
    </div>
  </div>
  <!--body-->
</body>

</html>